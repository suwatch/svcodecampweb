{
    "type": "controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "RegisterSpeakerAttendee"
    },
    "id": "ExtBox1-ext-gen36205",
    "designerId": "649a7ff9-eed4-4a08-8133-fc01c9df011f",
    "cn": [
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "checkEnableContinue",
                "fn": "checkEnableContinue",
                "implHandler": [
                    "\r",
                    "// we have username, password,haveaccount,forgot,create\r",
                    "// here are the rules to follow\r",
                    "//\r",
                    "// if (username & password have data) enable\r",
                    "// if (forgot checked or create new checke must have username)\r",
                    "// if (create new account checked, need both username and password\r",
                    "\r",
                    "var continuebutton;\r",
                    "\r",
                    "var username = Ext.ComponentQuery.query('AttendeeOrSpeakerAlias #username')[0].getValue();\r",
                    "var password = Ext.ComponentQuery.query('AttendeeOrSpeakerAlias #password')[0].getValue();\r",
                    "var haveaccount = Ext.ComponentQuery.query('AttendeeOrSpeakerAlias #haveaccount')[0].checked;\r",
                    "var forgot = Ext.ComponentQuery.query('AttendeeOrSpeakerAlias #forgot')[0].checked;\r",
                    "var create = Ext.ComponentQuery.query('AttendeeOrSpeakerAlias #create')[0].checked;\r",
                    "\r",
                    "//console.log('username: ' + username + ' password: ' + password);\r",
                    "//console.log('haveaccount: ' + haveaccount + ' forgot: ' + forgot + ' create: ' + create);\r",
                    "\r",
                    "\r",
                    "if ( (username.length > 0 && password.length > 0) ||\r",
                    "forgot === true || \r",
                    "create === true) {\r",
                    "    continueButton = Ext.ComponentQuery.query('AttendeeOrSpeakerAlias #continueButtonId')[0];\r",
                    "    if (continueButton.isDisabled()) {\r",
                    "        continueButton.enable();\r",
                    "    }\r",
                    "} else {\r",
                    "    continueButton = Ext.ComponentQuery.query('AttendeeOrSpeakerAlias #continueButtonId')[0];\r",
                    "    if (!continueButton.isDisabled()) {\r",
                    "        continueButton.disable();\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "var continueEnabledNow = !continueButton.isDisabled();\r",
                    "\r",
                    "//console.log('continueEnabled: ' + continueEnabledNow);\r",
                    "\r",
                    "return continueEnabledNow;\r",
                    "\r",
                    "\r",
                    ""
                ]
            },
            "designerId": "3fae00cd-ff13-4c45-8767-add21eff5696"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onBackButtonIdClick",
                "fn": "onBackButtonIdClick",
                "implHandler": [
                    "\r",
                    "//console.log('back button in registerspeakerattendee controller');\r",
                    "\r",
                    "var tabWizardPanel = Ext.getCmp('TabWizardId')\r",
                    "tabWizardPanel.setActiveTab(Ext.getCmp('TabWizardId').getTabIdByName('AttendeeSpeakerSponsorId'));\r",
                    ""
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "AttendeeOrSpeakerAlias #backButtonId"
            },
            "designerId": "21f821d5-ddf0-4526-a737-f87e0f7e591a"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|userClassName": "onContinueButtonIdClick",
                "fn": "onContinueButtonIdClick",
                "implHandler": [
                    "\r",
                    "//var continueEnabled = this.checkEnableContinue();\r",
                    "\r",
                    "\r",
                    "\r",
                    "var username = Ext.ComponentQuery.query('AttendeeOrSpeakerAlias #username')[0].getValue();\r",
                    "var password = Ext.ComponentQuery.query('AttendeeOrSpeakerAlias #password')[0].getValue();\r",
                    "var haveaccount = Ext.ComponentQuery.query('AttendeeOrSpeakerAlias #haveaccount')[0].checked;\r",
                    "var forgot = Ext.ComponentQuery.query('AttendeeOrSpeakerAlias #forgot')[0].checked;\r",
                    "var create = Ext.ComponentQuery.query('AttendeeOrSpeakerAlias #create')[0].checked;\r",
                    "\r",
                    "\r",
                    "//debugger;\r",
                    "var myMask = new Ext.LoadMask(Ext.getBody(), {msg:\"Logging In...\"});\r",
                    "\r",
                    "var tabPanel = Ext.ComponentQuery.query('tabWizardPanelAlias')[0];\r",
                    "\r",
                    "var attendeeFromFirstPage = Ext.ComponentQuery.query('AttendeeSpeakerOrSponsorAlias #rbAttendee')[0].checked;\r",
                    "var speakerFromFirstPage = Ext.ComponentQuery.query('AttendeeSpeakerOrSponsorAlias #rbSpeaker')[0].checked;\r",
                    "// (THIS IS SPEAKER OR ATTENDEE PAGE ONLY) var sponsorFromFirstPage = Ext.ComponentQuery.query('AttendeeOrSpeakerAlias #rbSponsor')[0].checked;\r",
                    "\r",
                    "if (haveaccount === true && (username.length < 3 || password.length < 4)) {\r",
                    "    Ext.MessageBox.alert('Problem','username must be at least 3 characters and password must be at least 4 characters');\r",
                    "}\r",
                    "else {\r",
                    "    var tabWizardPanel = Ext.getCmp('TabWizardId');\r",
                    "\r",
                    "    if (forgot === true) {\r",
                    "        tabWizardPanel.setActiveTab(tabWizardPanel.getTabIdByName('forgotusernameorpassword'));\r",
                    "    } else if (create === true) {\r",
                    "        // verify user entered does not exist\r",
                    "\r",
                    "\r",
                    "        if (username.length > 0) {\r",
                    "            Ext.Ajax.request({ \r",
                    "                url:'/rpc/Account/CheckUsernameEmailExists', \r",
                    "                actionMethods:'POST', \r",
                    "                scope:this, \r",
                    "                params:{\r",
                    "                    Username: username,\r",
                    "                    Password: password\r",
                    "                },\r",
                    "                success: function(r,o) {\r",
                    "\r",
                    "\r",
                    "\r",
                    "                    if (r.responseText.length > 2 && username.length > 0) {  // (this is because it returns \"\" instead of empty string)\r",
                    "                        Ext.Msg.alert('Error','Username exists, Try Again or use Forget Username or Password');\r",
                    "                    } else {\r",
                    "                        var thisPanel = Ext.ComponentQuery.query('AttendeeOrSpeakerAlias')[0];\r",
                    "                        var retData = thisPanel.getForm().getValues();\r",
                    "                        var createPanel = Ext.ComponentQuery.query('createAccountAlias')[0];\r",
                    "                        createPanel.getForm().setValues({\r",
                    "                            username: retData.username,\r",
                    "                            password: retData.password\r",
                    "                        });\r",
                    "                        tabWizardPanel.setActiveTab(tabWizardPanel.getTabIdByName('createAccount'));\r",
                    "                    }\r",
                    "                },\r",
                    "                failure: function(r,o) {\r",
                    "\r",
                    "\r",
                    "\r",
                    "                    Ext.Msg.alert('Error','Can not create username because it already exists');\r",
                    "                }\r",
                    "            });\r",
                    "        } else {\r",
                    "            tabWizardPanel.setActiveTab(tabWizardPanel.getTabIdByName('createAccount'));\r",
                    "        }\r",
                    "\r",
                    "\r",
                    "\r",
                    "\r",
                    "        tabWizardPanel.setActiveTab(tabWizardPanel.getTabIdByName('createnewaccount'));\r",
                    "    } else if (haveaccount) {\r",
                    "        // try logging person in and if fails, put up message and leave them here,\r",
                    "        // otherwise redirect to home page\r",
                    "\r",
                    "        //debugger;\r",
                    "\r",
                    "        // attempt to login.  only move to next page if login is successful.\r",
                    "        // if successful, then get data and load it into form before moving\r",
                    "        myMask.show();\r",
                    "\r",
                    "        Ext.Ajax.request({ \r",
                    "            url:'/rpc/Account/Login', \r",
                    "            actionMethods:'POST', \r",
                    "            scope:this, \r",
                    "            params:{\r",
                    "                Username: username,\r",
                    "                Password: password,\r",
                    "                RememberMe: true\r",
                    "            },\r",
                    "            success: function(r, o) { \r",
                    "\r",
                    "                //debugger;\r",
                    "\r",
                    "                //Ext.Msg.alert('Successful Login!');\r",
                    "\r",
                    "                var retData = Ext.JSON.decode(r.responseText);\r",
                    "\r",
                    "                if (attendeeFromFirstPage === false) {\r",
                    "                    // must be speaker\r",
                    "                    var speakerPanel = Ext.ComponentQuery.query('SpeakerAfterLoginAlias')[0];\r",
                    "                    speakerPanel.getForm().setValues(retData);\r",
                    "\r",
                    "\r",
                    "                    tabPanel.setActiveTab(tabPanel.getTabIdByName('SpeakerAfterLogin'));\r",
                    "\r",
                    "                } else {\r",
                    "                    // must be sponsor or attendee\r",
                    "                    var attendeePanel = Ext.ComponentQuery.query('AttendeeAfterLoginAlias')[0];\r",
                    "                    attendeePanel.getForm().setValues(retData);\r",
                    "                    tabPanel.setActiveTab(tabPanel.getTabIdByName('AttendeeAfterLogin'));\r",
                    "\r",
                    "                }\r",
                    "                myMask.hide();\r",
                    "\r",
                    "            },\r",
                    "            failure: function(r,o) {\r",
                    "\r",
                    "                Ext.Msg.alert('Failed Login!','Either Your password or username was not valid.  Please try again or choose forgot username or create account.');\r",
                    "                myMask.hide();\r",
                    "            }\r",
                    "        });\r",
                    "    }\r",
                    "}"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "AttendeeOrSpeakerAlias #continueButtonId"
            },
            "designerId": "898e5102-a4be-496e-9706-c6651f6a8880"
        }
    ]
}